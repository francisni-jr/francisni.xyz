<script context="module">
	export const TABS = {}
</script>

<script>import { get_current_component } from "svelte/internal";
import { onDestroy, setContext } from "svelte";
import { writable } from "svelte/store";
import { El } from "../el";
export let componentName = "tabs";
export let vertical = void 0;
const components = [
  { component: get_current_component(), except: [] },
  ...$$props.components ?? []
];
const tabs = [];
const panels = [];
const selectedTab = writable(null);
const selectedPanel = writable(null);
setContext(TABS, {
  registerTab: (tab) => {
    tabs.push(tab);
    selectedTab.update((current) => current || tab);
    onDestroy(() => {
      const i = tabs.indexOf(tab);
      tabs.splice(i, 1);
      selectedTab.update(
        (current) => current === tab ? tabs[i] || tabs[tabs.length - 1] : current
      );
    });
  },
  registerPanel: (panel) => {
    panels.push(panel);
    selectedPanel.update((current) => current || panel);
    onDestroy(() => {
      const i = panels.indexOf(panel);
      panels.splice(i, 1);
      selectedPanel.update(
        (current) => current === panel ? panels[i] || panels[panels.length - 1] : current
      );
    });
  },
  selectTab: (tab) => {
    const i = tabs.indexOf(tab);
    selectedTab.set(tab);
    selectedPanel.set(panels[i]);
  },
  selectedTab,
  selectedPanel
});
let cssProps = {};
$: {
  cssProps = { vertical };
}
</script>

<El {components} {...$$restProps} {componentName} {cssProps}>
	<slot />
</El>
